#!/usr/bin/env python3

"""
Bonito model viewer - display a model architecture for a given config.
"""

import toml
from bonito.model import Model
from argparse import ArgumentParser


def main(args):
    model = Model(toml.load(args.config))
    print(model)
    print("Total parameters in model", sum(p.numel() for p in model.parameters()))


if __name__ == "__main__":
    parser = ArgumentParser()
    parser.add_argument("config")
    main(parser.parse_args())
